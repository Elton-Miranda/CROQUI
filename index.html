<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CROQUI</title>
    
    <link rel="stylesheet" href="css/style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>

<div id="modalAjuda" class="modal">
    <div class="modal-content">
        <span class="close" onclick="fecharAjuda()">&times;</span>
        <h2 style="margin-top:0; color:#333;">Como usar o CROQUI</h2>
        <div class="help-step"><h4>1. Arrastar e Soltar</h4><p>ğŸ–±ï¸ Arraste itens para a tela.</p></div>
        <div class="help-step"><h4>2. Desenhar Cabos</h4><p>ğŸ”Œ Use Instalar/Retirar e arraste entre postes.</p></div>
        <div class="help-step"><h4>3. Notas Inteligentes</h4><p>ğŸ“ Digite "12 FusÃµes" no Post-it para contar no Excel.</p></div>
        <button class="btn-salvar" onclick="fecharAjuda()">ENTENDI!</button>
    </div>
</div>

<div class="container">
    <div class="sidebar">
        <div class="app-header">
            <h2>CROQUI</h2>
            <span>SoluÃ§Ã£o de Campo</span>
            <button class="btn-help-header" onclick="abrirAjuda()">â“ COMO USAR</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ“ IdentificaÃ§Ã£o / Notas</h3>
            <button class="btn-action" onclick="addNomeRua()"><span class="icon">ğŸ…°ï¸</span> Nome da Rua</button>
            <button class="btn-action" onclick="addObservacao()"><span class="icon">ğŸ“</span> Nota (Materiais)</button>
            <button id="btnArrow" class="btn-seta" onclick="ativarModoLinha('seta')"><span class="icon">â†—ï¸</span> Seta de Apontar</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ—ï¸ Infraestrutura (Arraste)</h3>
            <button draggable="true" ondragstart="drag(event, 'posteXC')" class="btn-infra"><span class="icon">I</span>Poste Concreto</button>
            <button draggable="true" ondragstart="drag(event, 'posteXM')" class="btn-infra"><span class="icon">I</span>Poste Madeira</button>
            <button draggable="true" ondragstart="drag(event, 'subidaLateral')" class="btn-infra" style="border-left: 3px solid #e74c3c;"><span class="icon">ğŸ“ˆ</span>Subida Lateral</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ“¦ Caixas e CS (Arraste)</h3>
            <div style="display: flex; gap: 4px;">
                <button draggable="true" ondragstart="drag(event, 'ceoExist')" class="btn-cx-exist">âš« Exist.</button>
                <button draggable="true" ondragstart="drag(event, 'ceoNova')" class="btn-cx-nova">âšª Nova</button>
            </div>
            <button draggable="true" ondragstart="drag(event, 'cs')" class="btn-cs"><span class="icon">â¬›</span>Caixa Subt. (CS)</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ”Œ Desenho de Cabos</h3>
            <div style="display: flex; gap: 4px;">
                <button id="btnInstall" class="btn-cabo-novo" onclick="ativarModoLinha('instalar')">Instalar</button>
                <button id="btnRet" class="btn-cabo-ret" onclick="ativarModoLinha('retirar')">Retirar</button>
            </div>
            <button id="btnCord" class="btn-cordoalha" onclick="ativarModoLinha('cordoalha')">Cordoalha (Guia)</button>
            <button id="btnPare" class="btn-parar" onclick="resetFerramentas()">âœ‹ Parar Desenho</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ“ MediÃ§Ãµes (PP)</h3>
            <div style="display: flex; gap: 4px;">
                <button class="btn-medida" onclick="addMedida('instalado')">Instalado</button>
                <button class="btn-medida" onclick="addMedida('retirado')" style="color: #27ae60; border-color: #27ae60; background:#e8f8f5;">Retirado</button>
            </div>
            <button class="btn-medida" onclick="addMedida('cordoalha')" style="color: #2980b9; border-color: #2980b9; background:#eafaf1;">Medir Cordoalha</button>
        </div>

        <div class="tool-group">
            <h3>ğŸ¨ CTOP (Arraste)</h3>
            <div class="ctop-grid">
                <button draggable="true" ondragstart="drag(event, 'ctop-EE82EE-01:08')" class="ctop-btn" style="background:#EE82EE;">01:08</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-FF0000-09:16')" class="ctop-btn" style="background:#FF0000; color:white;">09:16</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-0000FF-17:24')" class="ctop-btn" style="background:#0000FF; color:white;">17:24</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-FFFFFF-25:32')" class="ctop-btn" style="background:#FFFFFF;">25:32</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-FFFF00-33:40')" class="ctop-btn" style="background:#FFFF00;">33:40</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-008000-41:48')" class="ctop-btn" style="background:#008000; color:white;">41:48</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-008000-49:56')" class="ctop-btn" style="background:#008000; color:white;">49:56</button>
                <button draggable="true" ondragstart="drag(event, 'ctop-008000-57:64')" class="ctop-btn" style="background:#008000; color:white;">57:64</button>
            </div>
        </div>

        <div class="tool-group">
            <h3>ğŸ·ï¸ Tipo de Cabo</h3>
            <select id="tipoCabo" onchange="atualizarBitolas()">
                <option value="CFOA SM AS">CFOA SM AS</option>
                <option value="DROP">DROP</option>
            </select>
            <select id="bitolaCabo"></select>
            <button onclick="addEtiquetaCabo()" class="btn-action" style="background: #ecf0f1;">Inserir Tipo de Cabo</button>
        </div>

        <div style="margin-top: auto;">
             <button class="btn-action" onclick="deleteSelected()" style="background-color: #c0392b; color: white;">ğŸ—‘ï¸ Apagar Item</button>
             <button class="btn-salvar" onclick="finalizarTudo()">ğŸ’¾ SALVAR E GERAR EXCEL</button>
        </div>
    </div>

    <div class="canvas-area" id="dropZone">
        <div class="canvas-wrapper">
            <canvas id="c" width="1100" height="700"></canvas>
        </div>
    </div>
</div>

<script src="js/app.js"></script>

</body>
</html>